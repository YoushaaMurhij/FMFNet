
version: 2.1

orbs:
  python: circleci/python@0.2.1

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      DOCKER_IMAGE_NAME: x64/fmf:latest
      DOCKER_FILE_PATH: ./docker/Dockerfile

    steps:
      - uses: actions/checkout@v2
      - run: |
          docker build . --file ${{env.DOCKER_FILE_PATH}} --tag ${{env.DOCKER_IMAGE_NAME}}:latest
          docker tag ${{env.DOCKER_IMAGE_NAME}}:latest ${{env.DOCKER_IMAGE_NAME}}:${{ github.sha }}


workflows:
  main:
    jobs:
      - build
